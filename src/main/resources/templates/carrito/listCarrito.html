<!DOCTYPE html>
<html lang="en">
<head th:replace="fragments/head" />
<body>
	<!-- Barra de Navegaciï¿½n superior -->
	<nav th:replace="fragments/nav" />
	<div class="container">
		<h2>Lista del carrito</h2>
		<form class="navbar-form" action="/list">
			<div class="form-group">
				<input name="searchText" type="text" class="form-control" size="50"
					th:placeholder="Introduzca nombre o descripcion del producto" />
			</div>
			<button type="submit" class="btn btn-default"
				th:text>Buscar</button>
		</form>
		<h2>Lista del carrito</h2>		
		
		<p>Los productos que actualmente figuran en el carrito son los
			siguientes:</p>
		<div class="table-responsive">
			<table class="table table-hover" th:fragment="tableCarrito"
				id="tableCarrito">
				<thead>
					<tr>
						<th>Nombre</th>
						<th>Descripcion</th>
						<th>Precio</th>
						<th class="col-md-1"></th>
						<th class="col-md-1"></th>
						<th class="col-md-1"></th>
						<th class="col-md-1"></th>
						<th class="col-md-1"></th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="productosCarrito : carritoList">
						<td th:text="${productosCarrito.producto.nombre}">Nombre producto</td>
						<td th:text="${productosCarrito.producto.descripcion}">Descripcion producto</td>
						<td th:text="${productosCarrito.producto.precio}">Precio producto</td>
												
						<td><button type="button"
								th:id="${'incrementarButton' + productosCarrito.id" class="incrementar">Aumentar unidad</button></td>
								
						<td><button type="button"
								th:id="${'decrementarButton' + productosCarrito.id" class="decrementar">Decrementar Unidad</button></td>		
											
						<td><button type="button"
								th:id="${'eliminarButton' + productosCarrito.id" class="delete">Borrar
								de carrito</button></td>								
								
						
						<script th:inline="javascript">
									/*<![CDATA[*/
										$( "#incrementarButton[[${productosCarrito.id}]]" ).click(function() {
											$.get( "/carrito/aumentarUnidad/[[${productosCarrito.id}]]", function( data ) {
												var numberPage = [[${param.page}]];
												var urlUpdate = '/carrito/list/';
												if ( numberPage != null ){
													urlUpdate += "?page="+numberPage[0];
													}
												$("#tableCarrito").load(urlUpdate);
															});											
										});
									/*]]>*/
									</script>	
										
						<script th:inline="javascript">
									/*<![CDATA[*/
										$( "#decrementarButton[[${productosCarrito.id}]]" ).click(function() {
											$.get( "/carrito/decrementarUnidad/[[${productosCarrito.id}]]", function( data ) {
												var numberPage = [[${param.page}]];
												var urlUpdate = '/carrito/list/';
												if ( numberPage != null ){
													urlUpdate += "?page="+numberPage[0];
													}
												$("#tableCarrito").load(urlUpdate);
															});											
										});
									/*]]>*/
									</script>
								
						<script th:inline="javascript">
									/*<![CDATA[*/
										$( "#eliminarButton[[${productosCarrito.id}]]" ).click(function() {
											$.get( "/carrito/delete/[[${productosCarrito.id}]]", function( data ) {
												var numberPage = [[${param.page}]];
												var urlUpdate = '/carrito/list/';
												if ( numberPage != null ){
													urlUpdate += "?page="+numberPage[0];
													}
												$("#tableCarrito").load(urlUpdate);
															});											
										});
									/*]]>*/
									</script> 
					</tr>

				</tbody>
			</table>
		</div>
		<footer th:replace="fragments/pagination" />
	</div>

	<footer th:replace="fragments/footer" />
</body>
</html>